<!DOCTYPE html>
<html>
  <head>
    <title>WebApp</title>
    <meta charset="UTF-8">
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/main.css">

    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>

  </head>

  <body ng-app="">
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#"><strong>WebApp</strong> beta</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="#">Create</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Logout</a></li>
          </ul>
          <p id="p_loggedinas" class="navbar-text navbar-right">Logged in as <a href="#account" class="navbar-link">{{firstName}}</a></p>
        </div>
      </div>
    </nav>
    
    <div class="container-fluid">
      <div class="row">
        <div id="d_left_sidebar" class="col-sm-2">
          <p class="lead">Welcome, {{firstName}}</p>
          <p>You haven't logged in since <strong>{{lastSeen}}</strong></p>
          <input type="text" ng-model="firstName">
          
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingOne">
                <h4 class="panel-title">
                  <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    My calendars
                  </a>
                </h4>
              </div>
              <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                <div class="panel-body">
                  It seems like you haven't joined to or created any calendars...
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingTwo">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    My profile
                  </a>
                </h4>
              </div>
              <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                <div class="panel-body">
                  TODO: add in profile form for password update etc.
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                    Settings
                  </a>
                </h4>
              </div>
              <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                <div class="panel-body">
                  ??
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div id="d_main_col" class="col-sm-8">
          <span class="lead">My events for <strong>&lt;&lt;Jan 1</strong> - <strong>Jan 8&gt;&gt;</strong></span>
          <button id="b_refresh" type="button" class="btn btn-success">Refresh</button>
          <span>Display: </span>
          <div class="btn-group" role="group" aria-label="...">
          <button id="b_hide_left" type="button" class="btn btn-primary active" data-toggle="button">Left sidebar</button>
          <button id="b_hide_weekend" type="button" class="btn btn-primary active" data-toggle="button">Weekend</button>
          <button id="b_hide_right" type="button" class="btn btn-primary active" data-toggle="button">Right sidebar</button>
          </div>
          <table id="t_calendar" class="table">
            <tr>
              <th class="th_weekday">Monday</th>
              <th class="th_weekday">Tuesday</th>
              <th class="th_weekday">Wednesday</th>
              <th class="th_weekday">Thursday</th>
              <th class="th_weekday">Friday</th>
              <th class="th_weekend">Saturday</th>
              <th class="th_weekend">Sunday</th>
            </tr>
            <tr>
              <td>
                <div class="event">
                  <p class="e_title">Campus Tour</p>
                  <span class="e_time">14:00 - 15:00</span>
                  <!--<button type="button" class="btn btn-info btn-sm">v</button>-->
                  <p class="e_desc">Regular campus tour showing prospective students and their parents around the South Kensington Campus</p>
                </div>
              </td>
              <td>data</td>
              <td>data</td>
              <td>data</td>
              <td>data</td>
              <td>data</td>
              <td>data</td>
            </tr>
          </table>
        </div>
        
        <div id="d_right_sidebar" class="col-sm-2">
          <div id="d_right_sidebar" role="tabpanel">
            <!-- Nav tabs -->
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active"><a href="#crt_event" aria-controls="event" role="tab" data-toggle="tab">Event</a></li>
              <li role="presentation"><a href="#crt_calendar" aria-controls="calendar" role="tab" data-toggle="tab">Calendar</a></li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
              <div role="tabpanel" class="tab-pane fade in active" id="crt_event">Create event</div>
              <div role="tabpanel" class="tab-pane fade" id="crt_calendar">Create calendar</div>
            </div>

          </div>
        </div>
        
      </div> <!-- End of row -->
    </div> <!-- End of container -->
  
  <script>
    // Global variables
    var isLeftCollapsed = false;
    var isRightCollapsed = false;
    
    // DOCUMENT READY
    $(function() {
      // Bind weekend collapse
      $("#b_hide_weekend").click(function(){
        // TODO: check if this train reck is the only way to do this
        $("#t_calendar th:nth-of-type(6), #t_calendar td:nth-of-type(6), #t_calendar th:nth-of-type(7), #t_calendar td:nth-of-type(7)").toggle();
      });
      
      // Bind sidebar collapse
      $("#b_hide_left").click(function() {
        $("#d_left_sidebar").toggleClass("col-hidden col-sm-2");
        updateMainCol();
      });
      
      $("#b_hide_right").click(function() {
        $("#d_right_sidebar").toggleClass("col-hidden col-sm-2");
        updateMainCol();        
      });
      
      // Bind event description show button
      $(".event button").click(function() {
        $(this).next(".e_desc").toggle(500);
      });
    }); // End of document ready
    
    // Update main column class whether sizebars are hidden or not
    function updateMainCol() {
      var size = 8;
      if ($("#d_right_sidebar").hasClass("col-hidden")) {
        size += 2;
      }
      if ($("#d_left_sidebar").hasClass("col-hidden")) {
        size += 2;
      }
      $("#d_main_col").attr("class", "col-sm-" + size);
    }
  </script>
  </body>
</html>
